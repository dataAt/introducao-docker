\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{}
    \pretitle{\vspace{\droptitle}}
  \posttitle{}
    \author{}
    \preauthor{}\postauthor{}
    \date{}
    \predate{}\postdate{}
  

\begin{document}

{
\setcounter{tocdepth}{2}
\tableofcontents
}
\hypertarget{introducao}{%
\section{Introdu√ß√£o}\label{introducao}}

Desde seu surgimento, o Docker tem ganhado cada vez mais espa√ßo nos servidores mundo a fora, suas caracteristicas f√°ceis de entender e simples de aplicar permitem sua utiliza√ß√£o nos mais variados cen√°rios.

No √¢mbito cient√≠fico, o Docker vem sendo utilizado cada vez mais para a garantia da reprodutibilidade, uma vez que, suas caracter√≠sticas de isolamento de ambiente munidos da efici√™ncia, permitem a f√°cil distribui√ß√£o de ambientes j√° configurados para a execu√ß√£o dos trabalhos desenvolvidos, como @Boettiger2014 e @Schommer2014 apresentam.

O Instituto Nacional de Pesquisas Espaciais (INPE), por exemplo, faz a utiliza√ß√£o do Docker, para tornar os sistemas cient√≠ficos computacionais desenvolvidos mais acess√≠vel para todos que queiram fazer sua utiliza√ß√£o de uma forma simples e r√°pida.

Neste contexto, este material busca realizar uma introdu√ß√£o do Docker e os principais conceitos envolvidos na utiliza√ß√£o desta ferramenta. A cria√ß√£o deste material foi feita para ajudar a todos que queiram come√ßar a utilizar o Docker em seu dia-a-dia üòÑ.

\hypertarget{por-que-docker}{%
\subsection{Por que Docker ?}\label{por-que-docker}}

A resposta para esta pergunta pode ter v√°rias respostas, uma vez que, a depender do contexto onde voc√™ est√° inserido, o Docker pode trazer muitos benef√≠cios, vou colocar aqui em um contexto mais relacionado ao desenvolvimento de aplica√ß√µes. Ent√£o, vamos come√ßar imaginando que voc√™ √© um desenvolvedor Python, que est√° trabalhando em v√°rios projetos.

O primeiro projeto que voc√™ est√° trabalhando, est√° relacionado ao desenvolvimento de uma aplica√ß√£o \emph{web} e para isso, tem utilizado o PostgreSQL e Django, para realizar o desenvolvimento, j√° o segundo projeto, est√° ligado ao processamento de dados geoespaciais e voc√™ utilizou o GDAL e o numpy. Tudo bem at√© aqui ? √â um cen√°rio simples de imaginar.

Bem, como voc√™ desenvolve na mesma m√°quina e √© um desenvolvedor Python com bastante experi√™ncia em projetos, entende que, as depend√™ncias do projeto \emph{web} n√£o podem interferir no projeto de processamento de geodados. Para resolver este problema voc√™ cria ambientes virtuais dentro do Python, com isso, voc√™ consegue separar os projetos e garantir que, as bibliotecas e depend√™ncias de um projeto em momento algum ir√£o interferir em outro projeto, al√©m de permitir que voc√™ controle melhor as depend√™ncias de cada projeto.

Legal at√© aqui nada de diferente, e nem de Docker!

\begin{quote}
Calma, n√£o vou te enrolar, quero apenas que voc√™ entenda uma situa√ß√£o problema
\end{quote}

Ent√£o, voc√™ finaliza os dois projetos e eles devem ser distribuidos para todos e √© aqui que os problemas come√ßam, durante a instala√ß√£o das depend√™ncias, voc√™ percebeu que, dependendo da vers√£o do S.O, a biblioteca que voc√™ utilizou para se conectar ao PostgreSQL, SQLAlchemy, apresenta problemas quando tenta ser instalado com o \texttt{pip}, o que faz a instala√ß√£o dos \texttt{requirements.txt} dar problemas. E ainda, no projeto de processamento, uma das depend√™ncias, o GDAL, que facilita a leitura de dados espaciais tamb√©m tem o mesmo problema, dependendo da plataforma, ele tem problemas para instalar.

Ops! Os projetos est√£o prontos, por√©m as depend√™ncias podem dificultar a utiliza√ß√£o e implanta√ß√£o deles. √â aqui que entra o Docker, voc√™ vai criar duas \emph{imagens} (Ser√£o apresentadas mais para frente no material) com todo o seu projeto e o Docker vai garantir que, independende da plataforma ou do OS utilizado, eles v√£o funcionar.

Veja que interessante! Com o Docker, o famoso ``Na minha m√°quina funciona'' deixa de existir, e o projeto vai funcionar em todas as plataformas. Este √© um pequeno exemplo de o porque utilizar Docker, outros poderiam ser colocados aqui.

\begin{quote}
Esta mini hist√≥ria foi inserida apenas para voc√™ entender que o Docker pode te ajudar em problemas do dia-a-dia.
\end{quote}

\hypertarget{virtualizacao}{%
\subsection{Virtualiza√ß√£o}\label{virtualizacao}}

Bem, para come√ßarmos a falar de Docker, vamos antes falar um pouco sobre virtualiza√ß√£o, um conceito fundamental no entendimento do funcionamento do Docker.

Virtualiza√ß√£o √© o processo de criar ambientes virtuais isolados, providos por alguma ferramenta de gera√ß√£o deste ambiente (@Soltesz2007), sendo que existem duas formas de prover estes ambientes virtuais (@Chung2016), sendo elas as baseadas em container e as baseadas em hypervisor (@Morabito2015).

Na virtualiza√ß√£o baseada em hypervisor √© criado a representa√ß√£o virtual de um \emph{hardware} (@Firesmith), tamb√©m chamada de MV, que √© controlada por um hypervisor, sendo este uma camada que faz o interm√©dio de recursos entre o ambiente virtual criado e o \emph{hardware}, e neste ambiente virtual gerado, sistemas operacionais comuns podem ser executados. Esta representa√ß√£o de \emph{hardware} √© completamente isolada da m√°quina onde est√° sendo alocada (@Morabito2015), o que permite, por exemplo, que uma m√°quina que gera uma MV seja Linux, e o ambiente instalado dentro da MV seja Windows (@Morabito2015). O ponto de troca aqui √© que, o sistema operacional ter√° de ser instalado por completo dentro da MV (@Morabito2015).

A Figura abaixo apresenta a arquitetura das virtualiza√ß√µes hypervisor.

\includegraphics{res/1_intro/hypervisor_overview.svg}

Veja na Figura que, acima do hypervisor, que gera as representa√ß√µes virtuais de ambientes de execu√ß√£o, s√£o instalados todo o sistema operacional e ent√£o, as aplica√ß√µes podem come√ßar a ser executadas.

Por outro lado existem as t√©cnicas de virtualiza√ß√£o baseadas em containers, que s√£o executadas a n√≠vel de sistema operacional (@Firesmith), que realiza a emula√ß√£o de sistemas operacionais, ou partes de um, para a execu√ß√£o de processos e aplica√ß√µes, o grande diferencial desta forma de virtualiza√ß√£o √© que, um novo sistema operacional n√£o precisa ser instalado, uma vez que, as m√°quinas emuladas ter√£o como base o kernel e as bibliotecas do sistema operacional base, onde est√° sendo feito a virtualiza√ß√£o.

\begin{quote}
√â neste tipo de virtualiza√ß√£o que o Docker se encaixa.
\end{quote}

Mesmo com a caracterisca de compartilhamento de kernel e bibliotecas, os ambientes emulados continuam sendo isolados uns dos outros. Na Figura abaixo √© poss√≠vel visualizar como este m√©todo de virtualiza√ß√£o funciona.

\includegraphics{res/1_intro/container_overview.svg}

Veja que, n√£o h√° representa√ß√£o de v√°rias m√°quinas sendo criadas, e sim de aplica√ß√µes que est√£o sendo executadas, j√° que, neste m√©todo de virtualiza√ß√£o, cada um dos ambientes criados, tamb√©m chamados de \emph{containers}, normalmente executam um √∫nico processo, que pode por exemplo, ser a execu√ß√£o de uma aplica√ß√£o \emph{web}, ou mesmo um terminal \emph{bash}.

\hypertarget{docker}{%
\section{Docker üê≥}\label{docker}}

O Docker √© uma plataforma que usa o Linux Containers (LXC) para encapsular completamente aplicativos de software. √â um projeto de c√≥digo aberto apoiado por uma empresa privada que tem se concentrado no desenvolvimento do Docker como uma plataforma para hospedagem de aplicativos web f√°cil e escal√°vel.

O LXC √© uma tecnologia de virtualiza√ß√£o em n√≠vel de sistema operacional que cria um ambiente virtual totalmente em √°rea restrita no Linux sem a sobrecarga de uma m√°quina virtual completa. O Docker estende a tecnologia LXC, facilita o uso e fornece vers√µes, distribui√ß√£o e implanta√ß√£o f√°ceis. A sobrecarga de um cont√™iner do Docker √© muito menor que uma m√°quina virtual tradicional porque n√£o replica o sistema operacional completo, apenas as bibliotecas e bin√°rios do aplicativo sendo virtualizados.

Um cont√™iner Docker √© executado em um ambiente totalmente virtualizado, portanto, um algoritmo pode ser executado usando qualquer linguagem compat√≠vel com Linux (R, Python, C, Matlab, etc.) e ser compilado usando qualquer biblioteca compat√≠vel com Linux sem causar conflitos de vers√£o ou biblioteca com outros algoritmos. Al√©m disso, um cont√™iner Docker pode ser exportado e arquivado e executado a qualquer momento no futuro, com a confian√ßa de que o ambiente computacional ser√° id√™ntico, supondo que o projeto Docker permane√ßa compat√≠vel com vers√µes anteriores.

Docker √© uma aplica√ß√£o cliente-servidor, ou seja, toda sua comunica√ß√£o √© baseada em troca de dados atrav√©s de algum protocolo entre um cliente e o servi√ßo docker que est√° alocado no servidor.

\includegraphics{res/docker_api_infra.jpg}

\hypertarget{instalacao}{%
\subsection{Instala√ß√£o}\label{instalacao}}

Agora que temos uma vis√£o geral de funcionamento do docker, vamos fazer sua instala√ß√£o para podemos come√ßar a testar esta ferramenta e entender seus conceitos na pr√°tica. Aqui, por uma quest√£o de facilidade, recomenda-se a utiliza√ß√£o de um ambiente Linux. Os passos abaixo descrevem como a instala√ß√£o do Docker pode ser feita no Ubuntu \textbar{}16.04\textbar{} ou superior.

\begin{verbatim}
# Comandos para a instala√ß√£o do Docker no Ubuntu
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# sudo usermod -aG docker your-user
\end{verbatim}

Ao fazer esta instala√ß√£o voc√™ j√° tem tudo o que √© necess√°rio para o funcionamento do Docker em sua m√°quina.

Caso voc√™ esteja em outra plataforma, voc√™ pode consultar o site do Docker para verificar como instala-lo para a plataforma que voc√™ est√°, para isto clique \protect\hyperlink{}{aqui}

\hypertarget{containers}{%
\subsection{Containers}\label{containers}}

Os cont√™ineres armazenam todo o kit necess√°rio para um aplicativo, portanto, o aplicativo pode ser executado de forma isolada. Por exemplo, suponha que haja uma imagem do sistema operacional Ubuntu com o SQL SERVER, quando essa imagem for executada com o comando docker run, ser√° criado um cont√™iner e o SQL SERVER ser√° executado no sistema operacional Ubuntu.

S√£o nos \emph{containers} que as aplica√ß√µes, algoritmos e ambientes ser√£o executados e trabalhados {[}\ldots{}{]}. Mas voc√™ pode estar se perguntando: ``Como s√£o gerados os containers ?'', bem os containers s√£o criados atrav√©s da utiliza√ß√£o de imagens, e b√°sicamente um container representa uma imagem em tempo de execu√ß√£o.

Bom, agora precisamos entender o que s√£o as imagens de containers.

\hypertarget{imagens-de-containers}{%
\subsection{Imagens de containers}\label{imagens-de-containers}}

Agora que entendemos o que √© um \emph{container}, vejamos como eles s√£o criados. Como j√° apresentado anteriormente, os containers s√£o criados a partir de imagens, mas o que s√£o essas imagens ? Imagens b√°sicamente representam uma receita para a cria√ß√£o de \emph{container}.

Com esta receita os \emph{containers} podem ser criados de forma padronizada, seguindo sempre a mesma estrutura para a gera√ß√£o de ambientes e execu√ß√£o de sistemas. Mas agora voc√™ pode estar se perguntando, de onde vieram as imagens, bem, elas tamb√©m possuem uma receita durante sua gera√ß√£o, esta receita √© conhecida como \textbf{Dockerfile}. Vamos explicar como ela funciona.

Para ilustrar melhor, vejamos a figura abaixo, que apresenta a rela√ß√£o entre o dockerfile, a imagem e um container.
\includegraphics{res/docker_file_image_container.png}

\hypertarget{criando-imagens}{%
\subsubsection{Criando imagens}\label{criando-imagens}}

Para realizar a cria√ß√£o de imagens, como citado, utilizados os \texttt{Dockerfiles}, esses que s√£o arquivos que descrevem tudo o que um container deve ter quando for executado. Dentro do \texttt{Dockerfile} existem instru√ß√µes para ditar cada caracteristica que deve ser empregada no container. Para que voc√™ entenda melhor, vou mostrar um pequeno arquivo Dockerfile que cria um container que exibe uma mensagem e ent√£o √© finalizado. N√£o se preocupe caso voc√™ n√£o entenda de primeira, sem problemas! Vou explicar cada parte para ficar bem claro para voc√™.
- Lista os containers ativos: \texttt{docker\ ps}

\begin{itemize}
\item
  Lista todos os containers - (Independente do status): \texttt{docker\ ps\ -a}
\item
  Lista todas as imagens: \texttt{docker\ images}
\item
  Execu√ß√£o de um container: \texttt{docker\ run}
\end{itemize}

Nossa primeira imagem ira executar um script Python. Para come√ßarmos a fazer isso, vamos criar o \emph{script} python.

\begin{verbatim}
echo "print('Oi! Esta √© minha primeira imagem Docker! E ela funciona!')" > ola.py
\end{verbatim}

Com o \emph{script} python criado, vamos criar um arquivo com o nome \texttt{Dockerfile}, dentro deste arquivo, vamos inserir o seguinte conte√∫do.

\begin{verbatim}
FROM python:3
COPY ola.py ./

CMD [ "python", "./ola.py" ]
\end{verbatim}

Pronto! Ao fazer isto, basta ir novamente ao terminal e gerar a imagem, para fazer isso, utilize o comando que segue

\begin{verbatim}
docker build -t "minha_primeira_imagem" .
\end{verbatim}

Com este comando a sua imagem Docker ser√° criada. Para verificar se ela realmente foi criada execute o comando \texttt{docker\ images}, que lista todas as imagens dispon√≠veis para voc√™ utilizar. Ao digitar este comando voc√™ perceber√° que haver√° uma imagem com \texttt{minha\_primeira\_imagem}.

\begin{quote}
Caso queira apagar a imagem que criamos, utilize o comando docker rmi (docker rmi minha\_primeira\_imagem)
\end{quote}

Para utilizar a imagem criada para gerar um container, vamos fazer a execu√ß√£o da imagem

\begin{verbatim}
docker run minha_primeira_imagem
\end{verbatim}

\hypertarget{aquisicao-de-imagens}{%
\subsubsection{Aquisi√ß√£o de imagens}\label{aquisicao-de-imagens}}

Bem, mas existe alguma forma de eu compartilhar minhas imagens, ou mesmo utilizar alguma j√° feita pela comunidade, ou ao menos compartilhar meu Dockerfile? Sim! Voc√™ pode fazer isto atrav√©s da utiliza√ß√£o do registry! E voc√™ j√° fez a utiliza√ß√£o deste servi√ßo! Lembra na se√ß√£o anterior durante a cria√ß√£o do \texttt{Dockerfile}? Ent√£o, ali existia uma instru√ß√£o \texttt{FROM}, como explicado anteriormente, isso faz com que a sua imagem seja criada com base na imagem com o nome que voc√™ colocou, por√©m, se voc√™ lembrar foi inserido a seguinte instru√ß√£o \texttt{FROM\ python:3}, bem, mas voc√™ n√£o tem uma imagem na sua m√°quina com o nome \texttt{python:3}, ou pelo menos n√£o tinha at√© a execu√ß√£o do comando ? E como o docker faz isso, ele utiliza o registry!

Quando pedimos a execu√ß√£o de uma imagem, ou mesmo a utiliza√ß√£o dela para a cria√ß√£o de outra imagem, o docker-daemon busca esta imagem na sua m√°quina, caso n√£o encontra, vai para o registry p√∫blico, este nomeado de docker hub, l√°, caso ele encontre a imagem com o nome e a tag que voc√™ definiu, ele baixa ela e utiliza na opera√ß√£o que voc√™ definiu.

\hypertarget{arquitetura}{%
\subsection{Arquitetura}\label{arquitetura}}

Bem, agora que j√° conhecemos os principais componentes do ecossistema docker, vamos ampliar a imagem que apresenta a estrutura de funcionamento do docker cliente-servidor, naquele momento estavamos preocupados apenas em saber como n√≥s, clientes docker, nos poderiamos nos comunicar com o docker deamon, por√©m agora sabemos bastante sobre o ambiente docker.

Vejamos a figura abaixo:

\includegraphics{res/docker_arch.png}

Perceba que, o principio b√°sico que j√° haviamos visto ainda est√° presente, onde atrav√©s de uma API ou ferramenta de linha de comando (Que tamb√©m utiliza a API) nos comunicamos com o \emph{docker daemon}, por√©m agora podemos entender melhor que esta comunica√ß√£o representa. Veja que, ao nos comunicarmos com o docker daemon, podemos criar e gerenciar imagens, ou mesmo baixa-las do registry e ent√£o criar \emph{containers} a partir delas. Com isso temos um entendimento geral de como o docker trabalha, e agora podemos come√ßar a fazer sua gerencia =D.

\hypertarget{administrando-containers}{%
\subsection{Administrando containers}\label{administrando-containers}}

\hypertarget{criando-containers}{%
\subsubsection{Criando containers}\label{criando-containers}}

Os comandos aqui listados j√° foram apresentados anteriormente, por√©m, foram colocados aqui apenas para refor√ßar o significado de cada um dos par√¢metros inseridos

\hypertarget{gerenciando-as-execucoes-de-um-container}{%
\subsubsection{Gerenciando as execu√ß√µes de um container}\label{gerenciando-as-execucoes-de-um-container}}

\hypertarget{visualizando-o-status-do-container}{%
\subsubsection{Visualizando o status do container}\label{visualizando-o-status-do-container}}

\hypertarget{gerenciamento-de-memoria-e-cpu}{%
\subsubsection{Gerenciamento de mem√≥ria e CPU}\label{gerenciamento-de-memoria-e-cpu}}

\hypertarget{armazenamento}{%
\subsubsection{Armazenamento}\label{armazenamento}}

\hypertarget{rede}{%
\subsubsection{Rede}\label{rede}}

\hypertarget{um-pouco-mais-sobre-o-ecossistema-docker}{%
\subsection{Um pouco mais sobre o ecossistema Docker üêô}\label{um-pouco-mais-sobre-o-ecossistema-docker}}

\hypertarget{docker-cheat-sheet}{%
\section{Docker Cheat Sheet üìö}\label{docker-cheat-sheet}}

Recomenda-se que esta p√°gina seja utilizada para consulta, trazendo ao leitor uma forma simples e direta de consultar comandos do \texttt{Docker\ CLI} que lhe podem ser √∫teis.

\begin{itemize}
\item
  Listando os containers ativos: \texttt{docker\ ps}
\item
  Listando todos os containers - (Independente do status): \texttt{docker\ ps\ -a}
\item
  Listando todas as imagens: \texttt{docker\ images}
\item
  Executando um container: \texttt{docker\ run}
\item
  Executando um container - (Com terminal interativo): \texttt{docker\ run\ -ti\ debian\ /bin/bash}
\item
  Executando um container como daemon: \texttt{docker\ run\ -d}
\item
  Saindo do \emph{shell} de container sem finaliza-lo: CTRL + p + q
\item
  Finalizando um container (Quando conectado em seu \emph{shell}): CTRL + d
\item
  Acessar o entrypoint de um container em execu√ß√£o: \texttt{docker\ attach\ CONTAINER\_ID}
\item
  Criando o container: \texttt{docker\ create\ centos}
\item
  Parando um container: \texttt{docker\ stop\ CONTAINER\_ID}
\item
  Iniciando um container: \texttt{docker\ start\ CONTAINER\_ID}
\item
  Pausando um container: \texttt{docker\ pause\ CONTAINER\_ID}
\item
  Despausando um container: \texttt{docker\ unpause\ CONTAINER\_ID}
\item
  Verificando a quantidade de recursos utilizados pelo container: \texttt{docker\ stats\ CONTAINER\_ID}
\item
  Verificando os processos de um container: \texttt{docker\ top\ CONTAINER\_ID}
\item
  Visualizando os logs: \texttt{docker\ logs\ CONTAINER\_ID}
\item
  Removendo container desligado: \texttt{docker\ rm\ CONTAINER\_ID}
\item
  Removendo container em execu√ß√£o: \texttt{docker\ rm\ -f\ CONTAINER\_ID}
\item
  Verificando todas as informa√ß√µes de um container: \texttt{docker\ inspect\ CONTAINER\_ID}
\item
  Nomeando container no momento da execu√ß√£o: \texttt{docker\ run\ -ti\ -\/-name\ teste\ debian}
\item
  Verificando informa√ß√µes de mem√≥ria de um container: \texttt{docker\ inspect\ CONTAINER\_ID\ \textbar{}\ grep\ -i\ mem}
\item
  Limitando mem√≥ria RAM na execu√ß√£o do container (512 MB neste caso): \texttt{docker\ run\ -ti\ -\/-memory\ 512m\ -\/-name\ limited\_mem\ debian}
\item
  Alterando quantidade de mem√≥ria de um container j√° existente (256 MB neste caso): \texttt{docker\ update\ CONTAINER\_ID\ -\/-memory\ 256m}
\item
  Limitando CPU de um container no momento da execu√ß√£o (Neste caso propor√ß√£o de 1024): \texttt{docker\ run\ -ti\ -\/-cpu-shares\ 1024\ -\/-name\ container1\ debian}
\item
  Alterando limite de CPU em container em execu√ß√£o (Neste caso propor√ß√£o de 512): \texttt{docker\ update\ CONTAINER\_ID\ -\/-cpu-shares\ 512}
\item
  Criando volume: \texttt{docker\ run\ -ti\ -v\ /volume\ /bin/bash}
\item
  Mapeando volume: \texttt{docker\ run\ -ti\ -v\ /path/to/volume\_dir:/volume\ debian}
\item
  Verificando informa√ß√µes de volume: \texttt{docker\ inspect\ -f\ \{\{.Mounts\}\}\ CONTAINER\_ID}
\item
  Criando container data-only: \texttt{docker\ create\ -v\ /data\ -\/-name\ dbDados\ centos}
\item
  Criando container de banco de dados (Postgres) que utiliza o data-only: \texttt{docker\ run\ -d\ -p\ 5432:5432\ -\/-name\ pgsql1\ -\/-volumes-from\ dbdados\ -e\ POSTGRESQL\_USER=docker\ -e\ POSTGRESQL\_PASS=docker\ -e\ POSTGRESQL\_DB=docker\ kamui/postgresql}
\item
  Fazendo build de um Dockerfile que est√° no diret√≥rio atual: \texttt{docker\ build\ -t\ INSTITUICAO/NOME\_DA\_IMAGEM:VERSAO\ .}
\item
  Definindo DNS do container na execu√ß√£o: \texttt{docker\ run\ -ti\ -\/-dns\ ENDERECO\_DNS\ debian}
\item
  Criando link entre containers (Conex√£o entre \emph{containers}): \texttt{docker\ run\ -ti\ -\/-link\ container1\ -\/-name\ container2\ debian}
\item
  Abrindo porta do container na execu√ß√£o: \texttt{docker\ run\ -ti\ -\/-expose\ PORTA\ debian}
\item
  Definindo um MAC Address espec√≠fico para um container na execu√ß√£o: \texttt{docker\ run\ -ti\ -\/-mac-address\ 12:34:56:b0:6b:61\ debian}
\item
  Definindo a porta do container que ser√° publicada: \texttt{docker\ run\ -d\ -p\ PORTA\_HOST:PORTA\_CONTAINER\ debian}
\end{itemize}

\hypertarget{exemplos-de-uso}{%
\section{Exemplos de uso}\label{exemplos-de-uso}}

\hypertarget{postgres}{%
\subsection{Postgres}\label{postgres}}

\hypertarget{postgres-postgis}{%
\subsection{Postgres + PostGIS}\label{postgres-postgis}}

\hypertarget{pgadmin}{%
\subsection{pgAdmin}\label{pgadmin}}

\hypertarget{rstudio-server-geoespacial}{%
\subsection{RStudio server (Geoespacial)}\label{rstudio-server-geoespacial}}

\hypertarget{aplicacao}{%
\subsection{Aplica√ß√£o}\label{aplicacao}}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{from}\NormalTok{ flask }\ImportTok{import}\NormalTok{ Flask, escape, request}

\NormalTok{app }\OperatorTok{=}\NormalTok{ Flask(}\VariableTok{__name__}\NormalTok{)}

\AttributeTok{@app.route}\NormalTok{(}\StringTok{'/'}\NormalTok{)}
\KeywordTok{def}\NormalTok{ ola_no_container():}
\NormalTok{    nome }\OperatorTok{=}\NormalTok{ request.args.get(}\StringTok{"nome"}\NormalTok{)}
    \ControlFlowTok{return} \SpecialStringTok{f"Ol√°, }\SpecialCharTok{\{}\NormalTok{escape(nome)}\SpecialCharTok{\}}\SpecialStringTok{! Estou dentro de um container!"}

\ControlFlowTok{if} \VariableTok{__name__} \OperatorTok{==} \StringTok{'__main__'}\NormalTok{:}
\NormalTok{    app.run(debug}\OperatorTok{=}\VariableTok{True}\NormalTok{, host}\OperatorTok{=}\StringTok{'0.0.0.0'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
FROM python:3

# O container, no momento da execu√ß√£o, 'escuta' a porta 5000
EXPOSE 5000

COPY app.py ./

RUN "python -m pip install flask"

# Argumentos para o entrypoint
CMD [ "./app.py" ]

ENTRYPOINT [ "python" ]
\end{verbatim}

\begin{verbatim}
# Build
docker build -t "inpe/flaskapp:0.1" .

# Execu√ß√£o
docker run -d -p 5000:5000 inpe/flaskapp:0.1
\end{verbatim}

\hypertarget{portainer}{%
\subsection{Portainer}\label{portainer}}


\end{document}
